global:
  scrape_interval: 15s
  evaluation_interval: 15s
  external_labels:
    monitor: 'infrafabric-swarm'
    environment: 'production'
    cluster: 'primary'

# Alertmanager configuration
alerting:
  alertmanagers:
    - static_configs:
        - targets:
            - 'localhost:9093'
      path_prefix: '/'
      timeout: 10s

# Load rules once and periodically evaluate them
rule_files:
  # P0 Critical alerts
  - 'alerts/p0_critical.yml'
  # P1 High alerts
  - 'alerts/p1_high.yml'
  # P2 Medium alerts
  - 'alerts/p2_medium.yml'
  # Recording rules (optional)
  # - 'recording_rules.yml'

# Scrape configurations
scrape_configs:
  # Prometheus self-monitoring
  - job_name: 'prometheus'
    static_configs:
      - targets: ['localhost:9090']

  # API Gateway metrics
  - job_name: 'api-gateway'
    scrape_interval: 5s
    static_configs:
      - targets: ['localhost:8080']
    metrics_path: '/metrics'
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance

  # Redis exporter
  - job_name: 'redis'
    scrape_interval: 10s
    static_configs:
      - targets: ['localhost:6379']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'redis-primary'

  # ChromaDB exporter
  - job_name: 'chromadb'
    scrape_interval: 15s
    static_configs:
      - targets: ['localhost:8000']
    metrics_path: '/metrics'
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'chromadb-primary'

  # Agent swarm metrics
  - job_name: 'agent-swarm'
    scrape_interval: 5s
    static_configs:
      - targets: ['localhost:8001']
    metrics_path: '/metrics'
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance
        replacement: 'swarm-primary'

  # Node exporter (system metrics)
  - job_name: 'node'
    scrape_interval: 15s
    static_configs:
      - targets: ['localhost:9100']
    relabel_configs:
      - source_labels: [__address__]
        target_label: instance

  # Service discovery (optional - for dynamic environments)
  # - job_name: 'consul-sd'
  #   consul_sd_configs:
  #     - server: 'localhost:8500'
  #   relabel_configs:
  #     - source_labels: [__meta_consul_service]
  #       target_label: service
